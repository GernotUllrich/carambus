<% content_for(:title) { "#{@region.name} - Rankings" } %>

<% content_for(:navigation) do %>
  <%= render "show_links", dashboard: dashboard %>
<% end %>

<div class="main-content">
  <% @disciplines.each do |discipline| %>
    <section class="ranking-section mb-8">
      <% if @rankings_by_discipline[discipline].present? %>
        <h2 class="text-2xl font-bold mb-4"><%= discipline.name %> Rankings</h2>
        <div class="overflow-x-auto">
          <table class="min-w-full bg-white border border-gray-300">
            <thead>
              <tr class="bg-gray-100">
                <th class="px-4 py-2 border">Rank</th>
                <th class="px-4 py-2 border">Player</th>
                <th class="px-4 py-2 border">Club</th>
                <th class="px-4 py-2 border">GD <%= @seasons[0].name %></th>
                <th class="px-4 py-2 border">GD <%= @seasons[1].name %></th>
                <th class="px-4 py-2 border">GD <%= @seasons[2].name %></th>
                <th class="px-4 py-2 border">Effective GD</th>
              </tr>
            </thead>
            <tbody>
              <% @rankings_by_discipline[discipline].each do |ranking| %>
                <tr class="hover:bg-gray-50">
                  <td class="px-4 py-2 border text-center"><%= ranking[:rank] %></td>
                  <td class="px-4 py-2 border"><%=link_to ranking[:player].name, player_path(ranking[:player]) %></td>
                  <td class="px-4 py-2 border"><%= ranking[:club]&.name || '-' %></td>
                  <% ranking[:gd_values].each do |gd| %>
                    <td class="px-4 py-2 border text-right">
                      <%= number_with_precision(gd, precision: 2) if gd %>
                    </td>
                  <% end %>
                  <td class="px-4 py-2 border text-right font-bold">
                    <%= number_with_precision(ranking[:effective_gd], precision: 2) %>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      <% else %>
<!--        <p class="text-gray-500 italic">No rankings available for this discipline.</p>-->
      <% end %>
    </section>
  <% end %>
</div>
