<%#
# Show

This view is the template for the show page.
It renders the attributes of a resource,
as well as a link to its edit page.
%>

<% content_for(:title) { "Page: #{page.resource.title}" } %>

<header class="main-content__header">
  <h1 class="main-content__page-title"><%= content_for(:title) %></h1>

  <div>
    <%= link_to "Edit", [:edit, namespace, page.resource], class: "button" %>

    <% if page.resource.draft? %>
      <%= button_to "Publish", [:publish, namespace, page.resource], method: :post, class: "button" %>
    <% elsif page.resource.published? %>
      <%= button_to "Archive", [:archive, namespace, page.resource], method: :post, class: "button button--danger" %>
    <% end %>

    <% if page.resource.content_type == 'markdown' && page.resource.content.present? %>
      <%= link_to "Preview in New Tab", "/admin/pages/#{page.resource.id}/preview", target: "_blank", class: "button" %>
    <% end %>
  </div>
</header>

<section class="main-content__body">
  <dl>
    <dt>ID</dt>
    <dd><%= page.resource.id %></dd>

    <dt>Title</dt>
    <dd><%= page.resource.title %></dd>

    <dt>Summary</dt>
    <dd><%= page.resource.summary %></dd>

    <dt>Content</dt>
    <dd><pre><%= page.resource.content %></pre></dd>

    <dt>Parent Page</dt>
    <dd><%= page.resource.super_page&.title || "None" %></dd>

    <dt>Position</dt>
    <dd><%= page.resource.position %></dd>

    <dt>Content Type</dt>
    <dd><%= page.resource.content_type %></dd>

    <dt>Status</dt>
    <dd><%= page.resource.status %></dd>

    <dt>Published At</dt>
    <dd><%= page.resource.published_at || "Not published" %></dd>

    <dt>Tags</dt>
    <dd><pre><%= JSON.pretty_generate(page.resource.tags) %></pre></dd>

    <dt>Metadata</dt>
    <dd><pre><%= JSON.pretty_generate(page.resource.metadata) %></pre></dd>

    <dt>CRUD Minimum Roles</dt>
    <dd><pre><%= JSON.pretty_generate(page.resource.crud_minimum_roles) %></pre></dd>

    <dt>Version</dt>
    <dd><%= page.resource.version %></dd>

    <dt>Created At</dt>
    <dd><%= page.resource.created_at %></dd>

    <dt>Updated At</dt>
    <dd><%= page.resource.updated_at %></dd>
  </dl>

  <% if page.resource.content_type == 'markdown' && page.resource.content.present? %>
    <h2>Rendered Content</h2>
    <div style="background-color: #f5f5f5; padding: 10px; border-radius: 4px;">
      <%= raw page.resource.rendered_content %>
    </div>
  <% end %>
</section>
