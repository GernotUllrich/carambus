<%#
# Show

This view is the template for the show page.
It renders the attributes of a resource,
as well as a link to its edit page.
%>

<% content_for(:title) { "#{t('activerecord.models.page.one')}: #{page.resource.title}" } %>

<header class="main-content__header">
  <h1 class="main-content__page-title"><%= content_for(:title) %></h1>

  <div>
    <%= link_to t('admin.pages.show.edit'), [:edit, namespace, page.resource], class: "button" %>

    <% if page.resource.draft? %>
      <%= button_to t('admin.pages.show.publish'), [:publish, namespace, page.resource], method: :post, class: "button" %>
    <% elsif page.resource.published? %>
      <%= button_to t('admin.pages.show.archive'), [:archive, namespace, page.resource], method: :post, class: "button button--danger" %>
    <% end %>

    <% if page.resource.content_type == 'markdown' && page.resource.content.present? %>
      <%= link_to t('admin.pages.show.preview_in_new_tab'), "/admin/pages/#{page.resource.id}/preview", target: "_blank", class: "button" %>
    <% end %>
  </div>
</header>

<section class="main-content__body">
  <dl>
    <dt><%= t('activerecord.attributes.page.id') %></dt>
    <dd><%= page.resource.id %></dd>

    <dt><%= t('activerecord.attributes.page.title') %></dt>
    <dd><%= page.resource.title %></dd>

    <dt><%= t('activerecord.attributes.page.summary') %></dt>
    <dd><%= page.resource.summary %></dd>

    <dt><%= t('activerecord.attributes.page.content') %></dt>
    <dd><pre><%= page.resource.content %></pre></dd>

    <dt><%= t('activerecord.attributes.page.super_page_id') %></dt>
    <dd><%= page.resource.super_page&.title || t('admin.pages.show.none') %></dd>

    <dt><%= t('activerecord.attributes.page.position') %></dt>
    <dd><%= page.resource.position %></dd>

    <dt><%= t('activerecord.attributes.page.content_type') %></dt>
    <dd><%= t("activerecord.enums.page.content_type.#{page.resource.content_type}") %></dd>

    <dt><%= t('activerecord.attributes.page.status') %></dt>
    <dd><%= t("activerecord.enums.page.status.#{page.resource.status}") %></dd>

    <dt><%= t('activerecord.attributes.page.published_at') %></dt>
    <dd><%= page.resource.published_at || t('admin.pages.show.not_published') %></dd>

    <dt><%= t('activerecord.attributes.page.tags') %></dt>
    <dd><pre><%= JSON.pretty_generate(page.resource.tags) %></pre></dd>

    <dt><%= t('activerecord.attributes.page.metadata') %></dt>
    <dd><pre><%= JSON.pretty_generate(page.resource.metadata) %></pre></dd>

    <dt><%= t('activerecord.attributes.page.crud_minimum_roles') %></dt>
    <dd><pre><%= JSON.pretty_generate(page.resource.crud_minimum_roles) %></pre></dd>

    <dt><%= t('activerecord.attributes.page.version') %></dt>
    <dd><%= page.resource.version %></dd>

    <dt><%= t('activerecord.attributes.page.created_at') %></dt>
    <dd><%= page.resource.created_at %></dd>

    <dt><%= t('activerecord.attributes.page.updated_at') %></dt>
    <dd><%= page.resource.updated_at %></dd>
  </dl>

  <% if page.resource.content_type == 'markdown' && page.resource.content.present? %>
    <h2><%= t('admin.pages.show.rendered_content') %></h2>
    <div style="background-color: #f5f5f5; padding: 10px; border-radius: 4px;">
      <%= raw page.resource.rendered_content %>
    </div>
  <% end %>
</section>
