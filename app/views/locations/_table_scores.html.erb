<%- table_monitor_ = local_assigns[:table_monitor] %>
<%- location_ = local_assigns[:location] || table_monitor_.andand.location || @location %>
<%- if location_.present? %>
  <%- table_kinds = local_assigns[:table_kinds] || location_.table_kinds %>
  <h1 style="text-shadow: 2px 2px #000000" class="text-center text-gray-400 dark:text-gray-200 text-3vw mb-10"><%= "Laufende Partien" %>
    - <%= location_.name %></h1>
  <%- if table_kinds.present? -%>
    <%- table_kinds.each do |table_kind| %>
      <h4 style="text-shadow: 2px 2px #000000" class="flex text-gray-400 dark:text-white lg:mt-10"><%= table_kind.display_name %></h4>
      <div class="grid grid-cols-1 gap-4"></div>
      <div class="grid grid-cols-2 gap-4"></div>
      <div class="grid grid-cols-3 gap-4"></div>
      <div class="grid grid-cols-4 gap-4"></div>
      <div class="grid grid-cols-5 gap-4"></div>
      <div class="grid grid-cols-6 gap-4"></div>
      <div class="grid grid-cols-7 gap-4"></div>
      <%- tables_selected = location_.tables.select { |table| table.table_kind == table_kind && table.table_monitor.andand.game.present? } %>
      <%- cols = { 1 => 1, 2 => 2, 3 => 3, 4 => 4, 5 => 5, 6 => 6, 8 => 4, 9 => 5, 10 => 5, 11 => 6, 12 => 6, 13 => 7, 14 => 7, 15 => 5, 16 => 6, 17 => 6, 18 => 6 }[tables_selected.count] || 7 %>
      <turbo-frame id="teasers" class="grid grid-cols-<%= cols %> text-<%= cols < 4 ? "3" : "2" %>vw gap-8">
        <%- tables_selected.sort_by { |table| table.name }.reverse.each do |table| %>
          <div class="flex flex-col items-center">
            <!--            TODO maybe move DB accesses to controller-->
            <%- table_monitor = table.table_monitor %>
            <turbo_frame id="teaser_<%= table_monitor.id %>">
              <%= render partial: "table_monitors/teaser", locals: { table_monitor: table_monitor } %>
            </turbo_frame>
          </div>
        <% end %>
      </turbo-frame>
    <%- end %>
  <% end %>
<%- end %>
