<%#
  Partial f√ºr einzelne Wizard-Schritte
  
  Parameter:
  - number: Schrittnummer (1-6)
  - title: Titel des Schritts
  - status: :completed, :active, :pending
  - action: Hash mit :text, :path, :method, :confirm, :class
  - info: Zus√§tzliche Info (optional)
  - warning: Boolean - zeigt Warnung (optional)
  - danger: Boolean - markiert als gef√§hrliche Aktion (optional)
  - help: Hilfetext (optional)
%>
<%
  # Set defaults for optional parameters using local_assigns
  info = local_assigns.fetch(:info, nil)
  warning = local_assigns.fetch(:warning, false)
  danger = local_assigns.fetch(:danger, false)
  help = local_assigns.fetch(:help, nil)
  action = local_assigns.fetch(:action, nil)
%>

<div class="wizard-step <%= step_class(status) %> <%= 'wizard-step-danger' if danger %>">
  <div class="wizard-step-header">
    <div class="wizard-step-icon">
      <%= step_icon(status) %>
    </div>
    <div class="wizard-step-content">
      <div class="wizard-step-number-title">
        <span class="step-number"><%= number %>.</span>
        <h4 class="step-title"><%= title %></h4>
      </div>

      <% if info.present? %>
        <div class="step-info">
          <%= info %>
        </div>
      <% end %>

      <% if warning %>
        <div class="step-warning">
          <span class="warning-icon">‚ö†Ô∏è</span>
          Dieser Schritt ist noch offen
        </div>
      <% end %>

      <% if help.present? %>
        <div class="step-help">
          <details>
            <summary>üí° Was macht dieser Schritt?</summary>
            <p><%= help.html_safe %></p>
          </details>
        </div>
      <% end %>
    </div>
  </div>

  <div class="wizard-step-actions">
    <% if action && status == :active %>
      <%= button_to action[:text], action[:path],
          method: action[:method] || :get,
          class: "btn btn-primary #{action[:class]} #{status == :active ? 'btn-pulse' : ''}",
          data: { confirm: action[:confirm] } %>
    <% elsif action && status == :completed %>
      <%= button_to action[:text], action[:path],
          method: action[:method] || :get,
          class: "btn btn-secondary btn-sm #{action[:class]}" %>
    <% elsif status == :pending %>
      <span class="disabled-text">
        Erst verf√ºgbar nach vorherigem Schritt
      </span>
    <% end %>
  </div>
</div>
