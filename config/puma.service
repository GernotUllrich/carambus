[Unit]
Description=Puma HTTP Server for carambus_location_5101
After=network.target

[Service]
Type=simple
User=www-data
WorkingDirectory=/var/www/carambus_location_5101/current
Environment=PATH=/var/www/carambus_location_5101/shared/bundle/ruby/3.2.0/bin:/var/www/.rbenv/bin:/var/www/.rbenv/shims:/usr/local/bin:/usr/bin:/bin
Environment=RAILS_ENV=production
Environment=RBENV_ROOT=/var/www/.rbenv
Environment=RBENV_VERSION=3.2.1
ExecStart=/var/www/carambus_location_5101/shared/bundle/ruby/3.2.0/bin/bundle exec /var/www/carambus_location_5101/shared/bundle/ruby/3.2.0/bin/puma -C /var/www/carambus_location_5101/shared/puma.rb
ExecReload=/bin/kill -USR1 $MAINPID
Restart=always
RestartSec=1

# Ensure socket directory exists
ExecStartPre=/bin/mkdir -p /var/www/carambus_location_5101/shared/sockets
ExecStartPre=/bin/mkdir -p /var/www/carambus_location_5101/shared/pids
ExecStartPre=/bin/mkdir -p /var/www/carambus_location_5101/shared/log

[Install]
WantedBy=multi-user.target
